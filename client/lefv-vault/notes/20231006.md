---
id: 20231006
created_date: 06/10/2023
updated_date: 06/10/2023
type: daily-note
---
# 20231006
- **üè∑Ô∏èTags** : #10-2023  

## Notes

## Multiple syncs crash UI Node in Cluster

20231006_06:58:33 
// From VSCODE extension when trying to init the app
Observed: If multiple syncs are in process in an app with various dependencies, the UI Node k8 node crashes. Environment is left in unrecoverable state. 

```js

[C3.ai Extension] [2023-10-06T10:56:45.591Z] num of pkgs found in workspaceRoot: 16

[C3.ai Extension] [2023-10-06T10:56:45.629Z] Attempting to write following pkgs from ArtifactHub: genAiSearch,guruSearch

[C3.ai Extension] [2023-10-06T10:57:51.052Z] Failed to start app gurusearch with root package guruSearch due to: Error: <html>

<head><title>502 Bad Gateway</title></head>

<body>

<center><h1>502 Bad Gateway</h1></center>

<hr><center>nginx</center>

</body>

</html>

  

[C3.ai Extension] [2023-10-06T10:57:51.274Z] Attempt to write from ArtifactHub failed : <html>

<head><title>502 Bad Gateway</title></head>

<body>

<center><h1>502 Bad Gateway</h1></center>

<hr><center>nginx</center>

</body>

</html>

  

[C3.ai Extension] [2023-10-06T10:57:51.550Z] Sync has failed with following error: <html>

<head><title>502 Bad Gateway</title></head>

<body>

<center><h1>502 Bad Gateway</h1></center>

<hr><center>nginx</center>

</body>

</html>

```

## Current Workaround (Partial Fix Only)

Delete environment in node management portal (‚âà 10 minutes).

Delete local cached files:

```bash

# Function to clean directories and files
clean_v8_directories() {
  # If an argument is provided, use it as the root directory. Otherwise, use the current working directory.
  ROOT_DIR=${1:-$PWD}

  echo "Cleaning directories and files under: $ROOT_DIR"

  # Loop through each directory and file recursively to find directories named "gen" or ".vs-cache"
  # The -L option makes find follow symbolic links, so they are treated as the type of file to which they point.
  find -L "$ROOT_DIR" -type d \( -name "gen" -o -name ".vs-cache" \) -exec echo "Deleting directory: {}" \; -exec rm -rf {} \; -prune

  # Loop through each directory and file recursively to find files named ".fingerprints.txt"
  find -L "$ROOT_DIR" -type f -name ".fingerprints.txt" -exec echo "Deleting file: {}" \; -exec rm -rf {} \;

  UI_CLI_HOME="/Users/lefv/.vscode/extensions/c3ai.c3-ai-dx-v8-2.0.20/.uicli"
  rm -rf $UI_CLI_HOME \;
}

```
Raise new environment with different name (as name/cache conflicts appear to also affect behavior; ‚âà 10 minutes).

Sync application and dependencies (16 pages; ‚âà 20-30 minutes).

// From VSCode Extension when trying to resync
```

2023-10-06T15:05:32.787Z] Error downloading @c3_ui.tar.gz - {"message":"Wrapped c3.platform.err.C3RuntimeException: Error invoking JavaScript method UiSdlComponentsSourceCodeLoader#produceAll executing in runtime js on server: Error: Error generating code for component instance \"EnterpriseSearch.ChatBox\": JavaException: c3.platform.err.C3RuntimeException: Error invoking Java method UiSdlFileLoader#handleMissing: java.lang.Error: Unable to find type 'UiSdlConnected<UiSdlChat>' (UiSdlComponentsSourceCodeLoader.js#24)\n 22 );\n 23 } catch (e) {\n > 24 throw new Error('Error generating code for component instance \\\"' + chunkId + '\\\": ' + e.toString());\n 25 }\n 26 }, (UiSdlMetadataLoader.js#576)","cause":{"message":"Error: Error generating code for component instance \"EnterpriseSearch.ChatBox\": JavaException: c3.platform.err.C3RuntimeException: Error invoking Java method UiSdlFileLoader#handleMissing: java.lang.Error: Unable to find type 'UiSdlConnected<UiSdlChat>' (UiSdlComponentsSourceCodeLoader.js#24)","httpStatusCode":500,"filenameOfRootError":"UiSdlComponentsSourceCodeLoader.js","stackTrace":[{"fileName":"UiSdlComponentsSourceCodeLoader.js","lineNumber":24,"source":" 22 );\n 23 } catch (e) {\n> 24 throw new Error('Error generating code for component instance \\\"' + chunkId + '\\\": ' + e.toString());\n 25 }\n 26 },"}],"action":"UiSdlComponentsSourceCodeLoader#produceAll","engine":"js-server-rhino"},"httpStatusCode":500,"filenameOfRootError":"UiSdlMetadataLoader.js","stackTrace":[{"fileName":"UiSdlMetadataLoader.js","lineNumber":576,"source":" 574 // Generate source code for each chunk\n 575 function generateUiSdlComponentsSourceCode(rootPackage) {\n> 576 return UiSdlComponentsSourceCodeLoader.produceAll().files;\n 577 }"},{"fileName":"UiSdlMetadataLoader.js","lineNumber":458,"source":" 457 // From meta/*.json\n> 458 var uiComponentSourceCode = generateUiSdlComponentsSourceCode(rootPackage);\n 459 \n 460 // From *React.c3typ (mixes ReactComponent and UiSdlComponent)"},{"fileName":"UiSdlMetadataLoader.js","lineNumber":22,"source":" 20 function generateSourceFilesContentValues(

```

## Current Workaround (Partial Fix Only)

Delete environment in node management portal (‚âà 10 minutes).

Delete local cached files:

```bash

# Function to clean directories and files
clean_v8_directories() {
  # If an argument is provided, use it as the root directory. Otherwise, use the current working directory.
  ROOT_DIR=${1:-$PWD}

  echo "Cleaning directories and files under: $ROOT_DIR"

  # Loop through each directory and file recursively to find directories named "gen" or ".vs-cache"
  # The -L option makes find follow symbolic links, so they are treated as the type of file to which they point.
  find -L "$ROOT_DIR" -type d \( -name "gen" -o -name ".vs-cache" \) -exec echo "Deleting directory: {}" \; -exec rm -rf {} \; -prune

  # Loop through each directory and file recursively to find files named ".fingerprints.txt"
  find -L "$ROOT_DIR" -type f -name ".fingerprints.txt" -exec echo "Deleting file: {}" \; -exec rm -rf {} \;

  UI_CLI_HOME="/Users/lefv/.vscode/extensions/c3ai.c3-ai-dx-v8-2.0.20/.uicli"
  rm -rf $UI_CLI_HOME \;
}

```
Raise new environment with different name (as name/cache conflicts appear to also affect behavior; ‚âà 10 minutes).

Sync application and dependencies (16 pages; ‚âà 20-30 minutes).

## `UiSdlChat` throws Bundle Error in `genAiSearch` package

![[Pasted image 20231006112403.png]]

## Observation

20231006_11:25:39

```
Error downloading @c3_ui.tar.gz - {"message":"Wrapped c3.platform.err.C3RuntimeException: Error invoking JavaScript method UiSdlComponentsSourceCodeLoader#produceAll executing in runtime js on server: Error: Error generating code for component instance \"EnterpriseSearch.ChatBox\": JavaException: c3.platform.err.C3RuntimeException: Error invoking Java method UiSdlFileLoader#handleMissing: java.lang.Error: Unable to find type 'UiSdlConnected<UiSdlChat>' (UiSdlComponentsSourceCodeLoader.js#24)\n    22          );\n    23        } catch (e) {\n  > 24          throw new Error('Error generating code for component instance \\\"' + chunkId + '\\\": ' + e.toString());\n    25        }\n    26      }, (UiSdlMetadataLoader.js#576)","cause":{"message":"Error: Error generating code for component instance \"EnterpriseSearch.ChatBox\": JavaException: c3.platform.err.C3RuntimeException: Error invoking Java method UiSdlFileLoader#handleMissing: java.lang.Error: Unable to find type 'UiSdlConnected<UiSdlChat>' (UiSdlComponentsSourceCodeLoader.js#24)","httpStatusCode":500,"filenameOfRootError":"UiSdlComponentsSourceCodeLoader.js","stackTrace":[{"fileName":"UiSdlComponentsSourceCodeLoader.js","lineNumber":24,"source":"  22          );\n  23        } catch (e) {\n> 24          throw new Error('Error generating code for component instance \\\"' + chunkId + '\\\": ' + e.toString());\n  25        }\n  26      },"}],"action":"UiSdlComponentsSourceCodeLoader#produceAll","engine":"js-server-rhino"},"httpStatusCode":500,"filenameOfRootError":"UiSdlMetadataLoader.js","stackTrace":[{"fileName":"UiSdlMetadataLoader.js","lineNumber":576,"source":"  574  // Generate source code for each chunk\n  575  function generateUiSdlComponentsSourceCode(rootPackage) {\n> 576    return UiSdlComponentsSourceCodeLoader.produceAll().files;\n  577  }"},{"fileName":"UiSdlMetadataLoader.js","lineNumber":458,"source":"  457    // From meta/*.json\n> 458    var uiComponentSourceCode = generateUiSdlComponentsSourceCode(rootPackage);\n  459  \n  460    // From *React.c3typ (mixes ReactComponent and UiSdlComponent)"},{"fileName":"UiSdlMetadataLoader.js","lineNumber":22,"source":"  20  function generateSourceFilesContentValues(
```

## Current Workaround (Partial Fix Only)

Delete environment in node management portal (‚âà 10 minutes).

Delete local cached files:

```bash

# Function to clean directories and files
clean_v8_directories() {
  # If an argument is provided, use it as the root directory. Otherwise, use the current working directory.
  ROOT_DIR=${1:-$PWD}

  echo "Cleaning directories and files under: $ROOT_DIR"

  # Loop through each directory and file recursively to find directories named "gen" or ".vs-cache"
  # The -L option makes find follow symbolic links, so they are treated as the type of file to which they point.
  find -L "$ROOT_DIR" -type d \( -name "gen" -o -name ".vs-cache" \) -exec echo "Deleting directory: {}" \; -exec rm -rf {} \; -prune

  # Loop through each directory and file recursively to find files named ".fingerprints.txt"
  find -L "$ROOT_DIR" -type f -name ".fingerprints.txt" -exec echo "Deleting file: {}" \; -exec rm -rf {} \;

  UI_CLI_HOME="/Users/lefv/.vscode/extensions/c3ai.c3-ai-dx-v8-2.0.20/.uicli"
  rm -rf $UI_CLI_HOME \;
}

```
Raise new environment with different name (as name/cache conflicts appear to also affect behavior; ‚âà 10 minutes).

Sync application and dependencies (16 pages; ‚âà 20-30 minutes).

20231006_11:58:06

`Made post on GenAI field opps Teams page: [Luis Fernandez de la Vara: Everyone¬†-- I'm running into a situation where the vsce...](https://teams.microsoft.com/l/message/19:9c91e08dca9d495fb712497f65a4403b@thread.v2/1696607703650?context=%7B%22contextType%22%3A%22chat%22%7D)

sent on October 6, 2023 11:55`

---

20231006_12:14:17

@meeting @ben 

`https://c3energy.atlassian.net/browse/GENAI-2328`

---

## 20231006_01:04:00

@1-1 @Sean 



```
Hi -- fyi -- I am working from home today because I'm sick.
```

```
https://corneaicmptest2.c3-e.com/c3/studio/api/8/StudioEnv/fetch
```

## Links
- 